\nonstopmode{}
\documentclass[letterpaper]{book}
\usepackage[times,inconsolata,hyper]{Rd}
\usepackage{makeidx}
\usepackage[utf8,latin1]{inputenc}
% \usepackage{graphicx} % @USE GRAPHICX@
\makeindex{}
\begin{document}
\chapter*{}
\begin{center}
{\textbf{\huge Package `CategoricalDataAnalysis'}}
\par\bigskip{\large \today}
\end{center}
\begin{description}
\raggedright{}
\item[Type]\AsIs{Package}
\item[Title]\AsIs{Categorical Data Analysis}
\item[Version]\AsIs{1.0}
\item[Date]\AsIs{2017-11-30}
\item[Author]\AsIs{Maham Niaz, Saqib Ali}
\item[Maintainer]\AsIs{Maham Niaz }\email{maham.niaz@sjsu.edu}\AsIs{}
\item[Description]\AsIs{This package is used for analyzing two categorical variables.}
\item[License]\AsIs{GPL (>= 2)}
\item[Exports]\AsIs{count\_mat, plotlocalor, chisq.indep, odds.ratios, catbarchart,
continous2categorical}
\item[Imports]\AsIs{ggplot2, gridExtra}
\end{description}
\Rdcontents{\R{} topics documented:}
\inputencoding{utf8}
\HeaderA{CategoricalDataAnalysis-package}{Categorical Data Analysis}{CategoricalDataAnalysis.Rdash.package}
\aliasA{CategoricalDataAnalysis}{CategoricalDataAnalysis-package}{CategoricalDataAnalysis}
\keyword{package}{CategoricalDataAnalysis-package}
%
\begin{Description}\relax
This package is used for analyzing two categorical variables.  
\end{Description}
%
\begin{Details}\relax

The DESCRIPTION file:
This package was not yet installed at build time.\\{}

Index:  This package was not yet installed at build time.\\{}
\textasciitilde{}\textasciitilde{} An overview of how to use the package, including the most important functions \textasciitilde{}\textasciitilde{}
\end{Details}
%
\begin{Author}\relax
Maham Niaz, Saqib Ali

Maintainer: Maham Niaz <maham.niaz@sjsu.edu>
\end{Author}
%
\begin{References}\relax
\textasciitilde{}\textasciitilde{} Literature or other references for background information \textasciitilde{}\textasciitilde{}
\end{References}
%
\begin{SeeAlso}\relax
\textasciitilde{}\textasciitilde{} Optional links to other man pages, e.g. \textasciitilde{}\textasciitilde{}
\textasciitilde{}\textasciitilde{} \code{\LinkA{<pkg>}{<pkg>}} \textasciitilde{}\textasciitilde{}
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}

data("crabs2")
catbarchart(continous2categorical(crabs2))

\end{ExampleCode}
\end{Examples}
\inputencoding{utf8}
\HeaderA{catbarchart}{Plot Barchart for Categorical Data}{catbarchart}
\keyword{\textbackslash{}textasciitilde{}kwd1}{catbarchart}
\keyword{\textbackslash{}textasciitilde{}kwd2}{catbarchart}
%
\begin{Usage}
\begin{verbatim}
catbarchart(x)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] A Dataframe with Categorical Data. Last Column is the Response Variable
\end{ldescription}
\end{Arguments}
%
\begin{Author}\relax
Saqib Ali
\end{Author}
%
\begin{Examples}
\begin{ExampleCode}


# catbarchart create Barchart of Categorical Data. The last colmn of the Dataset should be the Response Variable. All variables should be Categorical Data. Use the continous2categorical function to conver Continous Data to Categorical Data

data("crabs2")
catbarchart(continous2categorical(crabs2))



## The function is currently defined as
function (x) 
{
    xcolumnnames <- colnames(x)
    responsecol <- ncol(x)
    plot_hist <- function(column, data, response) ggplot(data, 
        aes(x = get(column), ..count..)) + geom_bar(aes(fill = get(response)), 
        position = "dodge") + xlab(column) + scale_fill_discrete(name = response)
    myplots <- lapply(colnames(x), plot_hist, data = x, response = xcolumnnames[responsecol])
    myplots <- myplots[-length(myplots)]
    grid.arrange(grobs = myplots, ncol = 1)
  }
\end{ExampleCode}
\end{Examples}
\inputencoding{utf8}
\HeaderA{chisq.indep}{Testing for independence between two categorical variable  }{chisq.indep}
\keyword{\textbackslash{}textasciitilde{}kwd1}{chisq.indep}
\keyword{\textbackslash{}textasciitilde{}kwd2}{chisq.indep}
%
\begin{Description}\relax
This function takes in contingency matrix and tests for Chi Squared Independence. The function returns the two test statistics. 
X\textasciicircum{}2 and G\textasciicircum{}2, which is Pearson test statistic and Likelihood Ratio test statistic respectively.    
\end{Description}
%
\begin{Usage}
\begin{verbatim}
chisq.indep(m, level = 0.05, digits = 4, print = TRUE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{m}] 
m is an at least two by two matrix or the contingency matrix. Preferably with rows corresponding to explanatory variable
and coulmns corresponding to response variable.  

\item[\code{level}] 
level is the significance level of the test. 
The null hypothesis is rejected if the p-value is less than a predetermined level, alpha. 
alpha is called the significance level, and is the probability of rejecting the null hypothesis given that it is true (a type I error). 
The default value is set to 0.05. 

\item[\code{digits}] 
integer indicating the number of decimal places or significant digits to be used. The default is set to 4.  

\item[\code{print}] 
Default is set to TRUE. If print is set to TRUE the output of the test gets printed. 
If you do not want to see the output, set it equal to FALSE.

\end{ldescription}
\end{Arguments}
%
\begin{Value}
\begin{ldescription}
\item[\code{}] If print is set to TRUE returns the value of level, degree of freedom, critical value rounded to the neares digit, value of pearson statistic and value of likelihood ratio test statistic
\end{ldescription}




\end{Value}
%
\begin{Author}\relax
Maham Niaz
\end{Author}
%
\begin{Examples}
\begin{ExampleCode}
##---- Should be DIRECTLY executable !! ----
##-- ==>  Define data, use random,
##--	or do  help(data=index)  for the standard data sets.
#attach dataset crabs
  data("crabs2")
  #create a contingency matrix for crabs color and satelite 
  m = table(crabs2$color, crabs2$satellite)
  # returns chi squared test of independence for the two variable, color of the crab and satelite status, which is either TRUE or FALSE 
  chisq.indep(m)
  
  
  
## The function is currently defined as
function (m, level = 0.05, digits = 4, print = TRUE) 
{
    r.sum <- rowSums(m)
    c.sum <- colSums(m)
    n <- sum(m)
    exp.ct <- outer(r.sum, c.sum, "*")/n
    res <- m - exp.ct
    p.res <- res/sqrt(exp.ct)
    X.sq <- sum(p.res^2)
    G.sq <- 2 * sum(m * (log(m) - log(exp.ct)))
    df <- (nrow(m) - 1) * (ncol(m) - 1)
    c.val <- qchisq(level, df = df, lower.tail = FALSE)
    est.se <- sqrt(exp.ct * outer((1 - r.sum/n), (1 - c.sum/n), 
        "*"))
    s.res <- res/est.se
    if (print) {
        cat("Chi-squared test of independence\n")
        cat("  Level = ", level, ", df = ", df, ", critical value = ", 
            round(c.val, digits), "\n", sep = "")
        cat("  X-squared = ", round(X.sq, digits), "\n", sep = "")
        cat("  G-squared = ", round(G.sq, digits), sep = "")
      if(X.sq > c.val | G.sq > c.val){
      cat("\n", sep = "","The test statistic value is greater than critical value. We reject the null hypothesis and conclude that the two variable are not independent")
    } else {
      cat("\n", sep = "","The test statistic value is less than critical value. We fail to reject the null hypothesis and conclude that the two variable are independent")
    }
    }
    
  }
\end{ExampleCode}
\end{Examples}
\inputencoding{utf8}
\HeaderA{continous2categorical}{continous2categorical function.}{continous2categorical}
\keyword{\textbackslash{}textasciitilde{}kwd1}{continous2categorical}
\keyword{\textbackslash{}textasciitilde{}kwd2}{continous2categorical}
%
\begin{Description}\relax

continous2categorical function. This function takes a data frame of continous variables and converts to a data frame of categorical variables. The last variable is the response variable.

\end{Description}
%
\begin{Usage}
\begin{verbatim}
continous2categorical(x)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] A dataframe with Continous Variables for Factors. Last column is the Response Variable
\end{ldescription}
\end{Arguments}
%
\begin{Value}
A Dataframe with the Categorical variables. Last colums is the Response variable





\end{Value}
%
\begin{Examples}
\begin{ExampleCode}

data("crabs2")
continous2categorical(crabs2)

## The function is currently defined as
function (x) 
{
    numberoffactors <- ncol(x) - 1
    out <- data.frame(0, matrix(nrow = nrow(x), ncol = 1))
    for (i in 1:numberoffactors) {
        labs <- c("low", "low-medium", "medium", "medium-high", 
            "high")
        vartemp <- cut(x[, i], breaks = 5, labels = labs)
        out[i] <- vartemp
    }
    i <- i + 1
    out[i] <- x[i]
    colnames(out) <- colnames(x)
    return(data.frame(out))
  }
\end{ExampleCode}
\end{Examples}
\inputencoding{utf8}
\HeaderA{count\_mat}{creating contingency matrix for categorical data analysis}{count.Rul.mat}
\keyword{\textbackslash{}textasciitilde{}kwd1}{count\_mat}
\keyword{\textbackslash{}textasciitilde{}kwd2}{count\_mat}
%
\begin{Description}\relax
Takes a data frame of at least two observations of two categorical variables 
and returns a contingency table of the data 
\end{Description}
%
\begin{Usage}
\begin{verbatim}
count_mat(df)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{df}] 
df is a data frame with dimentions nx2 of two categorical variablles. 

\end{ldescription}
\end{Arguments}
%
\begin{Value}
\begin{ldescription}
\item[\code{m}] a contingency matrix of numerical values with dimension kxn where k is the number of categories in the first variable and n is the number of categories in the second variable   
\end{ldescription}





\end{Value}
%
\begin{Note}\relax
works similar to the table() function
\end{Note}
%
\begin{Author}\relax
Maham Niaz
\end{Author}
%
\begin{Examples}
\begin{ExampleCode}
##---- Should be DIRECTLY executable !! ----
##-- ==>  Define data, use random,
##--	or do  help(data=index)  for the standard data sets.

  #create vector 1 with three levels
  a = c("A","A","B","A", "B","B","C","A","C","B")
  #create vector 2 with 4 levels
  b = c(1,2,1,4,1,2,2,3,4,3)
  # create dataframe with a and b vectors as columns
  df = cbind(a,b)
  #return count matrix 
  m = count_mat(df)
  m
  
## The function is currently defined as
function (df) 
{
    df_dim <- dim(df)
    if (df_dim[2] == 2 && length(df_dim) == 2) {
        factor_df1 <- as.factor(df[, 1])
        factor_df2 <- as.factor(df[, 2])
        lev_col1 = levels(factor_df1)
        lev_col2 = levels(factor_df2)
        len_col1 = length(lev_col1)
        len_col2 = length(lev_col2)
        val = 1
        for (i in lev_col1) {
            for (j in lev_col2) {
                val = c(val, length(which(df[, 1] == i & df[, 
                  2] == j)))
            }
        }
        out = matrix(val[-1], byrow = TRUE, nrow = length(lev_col1), 
            dimnames = list(lev_col1, lev_col2))
    }
    else (out = "check dimension")
    return(out)
  }
\end{ExampleCode}
\end{Examples}
\inputencoding{utf8}
\HeaderA{crabs}{Horseshoe crabs data on characteristics of female crabs. The data includes color spine width weight and the number of satelites attracted by the male and female pair}{crabs}
\keyword{datasets}{crabs}
%
\begin{Description}\relax
contains the data analyzed by Brockmann (1996) and is discussed extensively in Agresti (2002). This is a space-delimited text file in which the variable names appear in the first row.
Background
\end{Description}
%
\begin{Usage}
\begin{verbatim}
data("crabs")
\end{verbatim}
\end{Usage}
%
\begin{Format}
A data frame with 174 observations on the following 5 variables.
\begin{description}

\item[\code{V1}] a factor with levels \code{2} \code{3} \code{4} \code{5} \code{color}
\item[\code{V2}] a factor with levels \code{1} \code{2} \code{3} \code{spine}
\item[\code{V3}] a factor with levels \code{21.0} \code{22.0} \code{22.5} \code{22.9} \code{23.0} \code{23.1} \code{23.2} \code{23.4} \code{23.5} \code{23.7} \code{23.8} \code{23.9} \code{24.0} \code{24.1} \code{24.2} \code{24.3} \code{24.5} \code{24.7} \code{24.8} \code{24.9} \code{25.0} \code{25.1} \code{25.2} \code{25.3} \code{25.4} \code{25.5} \code{25.6} \code{25.7} \code{25.8} \code{25.9} \code{26.0} \code{26.1} \code{26.2} \code{26.3} \code{26.5} \code{26.7} \code{26.8} \code{27.0} \code{27.1} \code{27.2} \code{27.3} \code{27.4} \code{27.5} \code{27.6} \code{27.7} \code{27.8} \code{27.9} \code{28.0} \code{28.2} \code{28.3} \code{28.4} \code{28.5} \code{28.7} \code{28.9} \code{29.0} \code{29.3} \code{29.5} \code{29.7} \code{29.8} \code{30.0} \code{30.2} \code{30.3} \code{30.5} \code{31.7} \code{31.9} \code{33.5} \code{width}
\item[\code{V4}] a factor with levels \code{0} \code{1} \code{10} \code{11} \code{12} \code{14} \code{15} \code{2} \code{3} \code{4} \code{5} \code{6} \code{7} \code{8} \code{9} \code{num.satellites}
\item[\code{V5}] a factor with levels \code{1200} \code{1300} \code{1400} \code{1475} \code{1550} \code{1600} \code{1650} \code{1700} \code{1800} \code{1850} \code{1900} \code{1950} \code{1967} \code{2000} \code{2025} \code{2050} \code{2100} \code{2150} \code{2175} \code{2200} \code{2225} \code{2250} \code{2275} \code{2300} \code{2350} \code{2400} \code{2450} \code{2500} \code{2550} \code{2600} \code{2625} \code{2650} \code{2700} \code{2750} \code{2800} \code{2850} \code{2867} \code{2900} \code{2925} \code{2950} \code{3000} \code{3025} \code{3050} \code{3100} \code{3150} \code{3200} \code{3225} \code{3250} \code{3275} \code{3300} \code{3325} \code{3500} \code{3600} \code{3725} \code{3850} \code{5200} \code{weight}

\end{description}

\end{Format}
%
\begin{Source}\relax
http://www.math.montana.edu/shancock/courses/stat539/data/horseshoe.txt
\end{Source}
%
\begin{Examples}
\begin{ExampleCode}
data(crabs)
str(crabs) #gives the summary of the dataset ; 
plot(crabs) 
  
\end{ExampleCode}
\end{Examples}
\inputencoding{utf8}
\HeaderA{crabs2}{contains the data analyzed by Brockmann (1996) and is discussed extensively in Agresti (2002). This is a space-delimited text file in which the variable names appear in the first row. Background}{crabs2}
\keyword{datasets}{crabs2}
%
\begin{Usage}
\begin{verbatim}
data("crabs2")
\end{verbatim}
\end{Usage}
%
\begin{Format}
A data frame with 173 observations on the following 5 variables.
\begin{description}

\item[\code{color}] a numeric vector
\item[\code{spine}] a numeric vector
\item[\code{width}] a numeric vector
\item[\code{weight}] a numeric vector
\item[\code{satellite}] a logical vector

\end{description}

\end{Format}
%
\begin{Examples}
\begin{ExampleCode}
data(crabs2)
## maybe str(crabs2) ; plot(crabs2) ...
\end{ExampleCode}
\end{Examples}
\inputencoding{utf8}
\HeaderA{odds.ratios}{creating a table with local or global odds ratios }{odds.ratios}
\keyword{\textbackslash{}textasciitilde{}kwd1}{odds.ratios}
\keyword{\textbackslash{}textasciitilde{}kwd2}{odds.ratios}
%
\begin{Description}\relax
This function takes in a contingency table and returns local or global odds ratios for all the subtables formed from the table. 
The function gives out the odds ratios in the form of n-1 by m-1 matrix.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
odds.ratios(m, type = "local")
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{m}] 
The two dimentional contingency table for which all the local and global odds ratios are required

\item[\code{type}] 
the type of odds ratios required. This argument can take values local or global only. The default is set to local.
Note that global odds ratios make sense for ordinal data for both variables. 

\end{ldescription}
\end{Arguments}
%
\begin{Value}
\begin{ldescription}
\item[\code{result}] a matrix of odds ratios is returned. The dimentions  of the matrix are n-1 by k-1 where n and k are the number of rows and columns of contingency table m
\end{ldescription}





\end{Value}
%
\begin{Author}\relax
Maham Niaz
\end{Author}
%
\begin{Examples}
\begin{ExampleCode}
##---- Should be DIRECTLY executable !! ----
##-- ==>  Define data, use random,
##--	or do  help(data=index)  for the standard data sets.
 #attaching dataset crabs2
 data("crabs2")
 # create contingency matrix for variable spine and satelite 
 m = table(crabs2$spine, crabs2$satellite)
 or1 = odds.ratios(m, "global")
 or1 #gives matrix for global odds ratios
 or2 = odds.ratios(m)
 or2 #gives matrix for local odds ratios

## The function is currently defined as
function (m, type = "local") 
{
    nr <- nrow(m)
    if (nr < 2) 
        stop("number of rows is less than two")
    nc <- ncol(m)
    if (nc < 2) 
        stop("number of columns is less than two")
    if (length(type) > 1) 
        stop("only one type is allowed")
    opts <- c("local", "global")
    type <- pmatch(type, opts)
    if (is.na(type)) 
        stop("only \"local\" or \"global\" allowed for type")
    result <- matrix(NA, nrow = nr - 1, ncol = nc - 1)
    if (type == 1) 
        for (i in 1:(nr - 1)) for (j in 1:(nc - 1)) result[i, 
            j] <- m[i, j] * m[i + 1, j + 1]/(m[i, j + 1] * m[i + 
            1, j])
    if (type == 2) 
        for (i in 1:(nr - 1)) for (j in 1:(nc - 1)) {
            num <- as.numeric(sum(m[1:i, 1:j])) * as.numeric(sum(m[(i + 
                1):nr, (j + 1):nc]))
            den <- as.numeric(sum(m[1:i, (j + 1):nc])) * as.numeric(sum(m[(i + 
                1):nr, 1:j]))
            result[i, j] <- num/den
        }
    result
  }
\end{ExampleCode}
\end{Examples}
\inputencoding{utf8}
\HeaderA{plotlocalor}{plotting fourfold plots for odds ratios }{plotlocalor}
\keyword{\textbackslash{}textasciitilde{}kwd1}{plotlocalor}
\keyword{\textbackslash{}textasciitilde{}kwd2}{plotlocalor}
%
\begin{Description}\relax
This function takes in a contingency table and returns (k-1)(l-1) fourfold plots for odds ratio of all 2x2 subtables in the matrix 
m with dimentions kxl 
\end{Description}
%
\begin{Usage}
\begin{verbatim}
plotlocalor(m, col = c("azure4", "aquamarine4"))
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{m}] 
a two dimentional contingency matrix

\item[\code{col}] 
The color of the four-fold plots. The default is azure4 and aquamarine4. The second color corresponds to the 
variable with higher odds of success.

\end{ldescription}
\end{Arguments}
%
\begin{Author}\relax
Maham Niaz
\end{Author}
%
\begin{Examples}
\begin{ExampleCode}
##---- Should be DIRECTLY executable !! ----
##-- ==>  Define data, use random,
##--	or do  help(data=index)  for the standard data sets.

  #create 2x2 matrix
  m = matrix(c(1,5,13,6), nrow=2)
  plotlocalor(m) # returns a single plot shpwing descriptive summary of odds ratio
  
  #create 4x4 matrix
  m = matrix(c(1,5,13,6,3,5,14,16,36,45,4,6,5,8,9,56), nrow = 4)
  plotlocalor(m) # returns 3x3 plots for the odds ratios of 2x2 subtables in the m matrix
  
## The function is currently defined as
function (m, col = c("azure4", "aquamarine4")) 
{
    nr <- nrow(m)
    if (nr < 2) 
        stop("number of rows is less than two")
    nc <- ncol(m)
    if (nc < 2) 
        stop("number of columns is less than two")
    par(mfrow = c(nr - 1, nc - 1))
    for (i in 1:(nr - 1)) for (j in 1:(nc - 1)) {
        fourfoldplot(m[i:(i + 1), j:(j + 1)], color = col)
    }
  }
\end{ExampleCode}
\end{Examples}
\printindex{}
\end{document}
